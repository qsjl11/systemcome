# SystemCome 系统状态文档

## 系统概述
SystemCome是一个基于LLM的游戏系统，玩家扮演"系统"角色，通过与LLM驱动的主角互动来推进故事发展。游戏通过网页端进行交互，采用类似ChatGPT的对话形式。

## 当前系统架构

### 后端架构
1. Flask Web服务器 (flask_app/app.py)
   - 提供Web API接口
   - 支持普通对话和SSE流式对话
   - 处理用户输入和系统响应

2. LLM服务 (flask_app/llm_service.py)
   - 使用OpenAI API接口（当前配置为DeepSeek）
   - 支持异步响应生成
   - 包含重试机制和错误处理
   - 通过环境变量配置模型参数

### 前端架构
1. 网页界面 (flask_app/templates/chat.html)
   - 响应式设计
   - 支持移动端访问
   - Markdown渲染支持

2. 交互功能 (flask_app/static/script.js)
   - 对话管理（新建、切换、删除）
   - 实时消息流处理
   - 自动滚动和加载动画
   - 移动端菜单支持

## 当前实现功能
1. 基础对话系统
   - 支持多轮对话
   - 支持流式响应
   - 支持Markdown格式化
   
2. 对话管理
   - 创建新对话
   - 切换对话
   - 删除对话
   - 对话历史保存

3. 用户界面
   - 响应式布局
   - 移动端支持
   - 加载动画
   - 实时预览

## 待实现功能
1. 游戏核心机制
   - 系统能量值管理
   - 主角状态管理
   - 世界状态管理
   - 任务系统

2. 主角AI实现
   - 性格系统
   - 决策系统
   - 行动系统
   - 记忆系统

3. 世界系统
   - 世界状态一致性维护
   - 情境管理
   - 事件系统

4. 系统功能
   - 存档功能
   - 游戏设置
   - 系统状态展示
   - 任务管理界面

## 下一步开发计划
1. 实现主角状态管理
   - 设计主角属性系统
   - 实现主角状态存储
   - 开发主角状态更新机制

2. 实现系统能量值
   - 设计能量值计算规则
   - 实现能量值消耗机制
   - 开发能量值恢复系统

3. 实现任务系统
   - 设计任务数据结构
   - 实现任务发布机制
   - 开发任务追踪系统

4. 优化对话系统
   - 增加角色设定
   - 实现上下文管理
   - 优化响应质量

## 技术债务
1. 需要添加单元测试
2. 需要实现错误处理机制
3. 需要优化数据存储方案
4. 需要添加日志系统
5. 需要实现配置管理系统

## 最近更新
- 2024/1/31: 初始化系统文档
- 完成基础对话系统实现
- 完成前端界面基本功能
- 完成LLM服务集成
